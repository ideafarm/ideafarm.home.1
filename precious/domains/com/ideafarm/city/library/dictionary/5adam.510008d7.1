
//
// Copyright (c) 1992-2025 Wo Of Ideafarm.  All rights reserved.  See https://github.com/ideafarm/ideafarm.home.1 for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 33 years.
// Respecting the rights of other people is an important part of empowering one another.
//

REST

sgnDone_tmWorkF.waitF( tin0P ) ;
ether.osThreadF( TaRG3sGNdONEcBsTACK( tmWorkF , sgnDone_tmWorkF , TICK ) ) ;     //U::O: REPLACE "TICK" WITH MINIMUM cbStackP VALUE THAT WORKS RELIABLY
signC sgnDone_tmWorkF( tin0P , TAG( TAGiDnULL ) ) ;

TODO

DONE( tmWorkF )
}
    }
        ++ s ; ether.osSleepF( tin0P , TOCK >> 0 ) ;

        }
            nnSubnet48Lath = nnSubnet48 ;

            }
                }
                    etThread.traceF( tin0P , T("hired plink to freshen the bird configuration on router [value]:    ")+TF2(c4Result.c3,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED) ) ;
                    count4S c4Result = etThread.ifcHireF( tin0P , T("ifcIDaDAM_IDEAnETcONTROLrOUTER") , ifcIDaDAM_HIREwITHOUTdEBUGGING , T("!hireLater plink.exe ")+tArgsBirdConfigure , flHIRE_DISPLAYnONE | flHIRE_WAIT ) ;
                {
                if( bOk )

                }
                    }
                        etRock.traceF( tin0P , T("!exception / could not write to router share ; ignoring [rc,tLong]:    ")+TF2(rc,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED)+tb4+tLong ) ;
                        POOPRqUIET
                        countT rc = POOP ;
                    {
                    else
                    }
                        etRock.traceF( tin0P , T("i wrote aok to router share [tLong]:    ")+tLong ) ;
                        bOk = 1 ;
                    {
                    if( !POOP )
                    ((tin1S&)tin0P).pEtScratch->boxPutF( tin0P , tLong , tSay , tSay.csF( tin0P ) ) ;
                    SCOOPS
                    _IO_
                {
                IFsCRATCHoK
                ZE( boolT , bOk ) ;

                tSay += tImage5 ;

                etThread.traceF( tin0P , T("subnets to advertise   (end)" DASH79) ) ;
                }
                    while( ~hWalk ) ;
                    }
                        tSay += tImage3+T(nnWo)+tImage4 ;
                        etThread.traceF( tin0P , T("[nnWo]:    ")+T(nnWo)+T("/48") ) ;
                        nicNameC& nnWo = (nicNameC&)stNnSubnetSay.downF( tin0P , hWalk ) ;
                    {
                    do
                    handleC hWalk( tin0P , TAG( TAGiDnULL ) , ifcIDtYPEhANDLE_STACKwALK ) ;
                {
                if( stNnSubnetSay )
                etThread.traceF( tin0P , T("subnets to advertise (begin)" DASH79) ) ;

                TN( tSay , "" ) ; tSay = tImage1+tBgpPassword+tImage2 ;

                stNnSubnetSay.purgeF( tin0P , 4 ) ;     //U:: 4: to see whether i can do 4 routes
                stNnSubnetSay << nnSubnet48 ;
            {
            if( nnSubnet48Lath != nnSubnet48 )

            etThread.traceF( tin0P , T("addNicAddressCBF [minute,nnNow,nnAdvertise]:    ")+TF2(minute,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED)+tb4+T(nnNow)+tb4+T(nnSubnet48) , flTRACE_NOpREFIX ) ;

            //nicNameC nnSubnet36 = nnNow( 0x24 ) ;
            nicNameC nnSubnet48 = nnNow( 0x30 ) ;
            const nicNameC nnNow = woSub.nnF( tin0P , minute ) ;

            minuteLath = minute ;
        {
        if( minuteLath != minute )
        countT minute = timeN1 >> 0x14 ;

        etThread.osTimeNowF( tin0P , timeN1 , timeN2 ) ;
        ZE( sCountT , timeN2 ) ;
        ZE( countT  , timeN1 ) ;

        }
            etThread.traceF( tin0P , T("addNicAddressCBF [       nnMax] :          ")+tMax , flTRACE_NOpREFIX ) ;
            etThread.traceF( tin0P , T("addNicAddressCBF [       nnMin] :          ")+tMin , flTRACE_NOpREFIX ) ;
        {
        if( !minuteLath )
    {
    while( !ether )
    stackC stNnSubnetSay( tin0P , etThread , TAG( TAGiDnULL ) , flSTACKc_DOnOTsERIALIZE | flSTACKc_FIFO , ifcSTACKtYPE_nicNameC ) ;
    nicNameC nnSubnet48Lath ;
    ideaNetSubscriptionC woSub( tin0P , etThread , 1 , 1 , T("foo") , T("goo@hoo") ) ;
    sleepC s( tin0P , TAG( TAGiDnULL ) ) ;
    ZE( countT , minuteLath ) ;
    TN( tLong , "////10.0.4.1/bird/bird.conf" ) ;
    TN( tMax , "2602:FF03:0FFF:FFFF:FFFF:FFFF:FFFF:FFFF" ) ;
    TN( tMin , "2602:FF03:0000::" ) ;
    TN( tDash , DASH127 ) ;
    TN( tFileSuffix , "/48\r\n" ) ;
    TN( tFilePrefix , "- " ) ;
    TN( tb4 , "    " ) ;

    TN( tArgsBirdConfigure , "" ) ; tArgsBirdConfigure = T("-batch -l root -pw ")+tRouterPassword+T(" 10.0.4.1 \"birdc configure\"") ;

    }
        etThread.delF( tin0P , psttv ) ;
        tBgpPassword = T(psttv) ;
        ZE( strokeS* , psttv ) ; etThread.querySettingF( tin0P , psttv , T("!ipdos.ideanet.bgp.password")  ) ; ___( psttv ) ;
    {
    TN( tBgpPassword , "" ) ;

    }
        etThread.delF( tin0P , psttv ) ;
        tRouterPassword = T(psttv) ;
        ZE( strokeS* , psttv ) ; etThread.querySettingF( tin0P , psttv , T("!ipdos.ideanet.router.password")  ) ; ___( psttv ) ;
    {
    TN( tRouterPassword , "" ) ;

    ) ;

        "}\n"
        "    scan time 5 ;\n"
        "{\n"
        "protocol device\n"
        "\n"
        "}\n"

    TN( tImage5 ,

    ) ;

        "/48 via 2001:19f0:ac00:4406:5400:05ff:fee9:27e6 ;\n"

    TN( tImage4 ,

    ) ;

        "    route "

    TN( tImage3 ,

    ) ;

        "    ipv6 ;\n"
        "{\n"
        "protocol static\n"
        "\n"
        "}\n"
        "    } ;\n"
        "        export all  ;\n"
        "        import none ;\n"
        "    ipv6 {\n"
        "    graceful restart on ;\n"
        "    multihop 2 ;\n"
        "\" ;\n"

    TN( tImage2 ,

    ) ;

        "    password \""
        "    neighbor       2001:19f0:ffff::1                       as      64515 ;\n"
        "    source address 2001:19f0:ac00:4406:5400:05ff:fee9:27e6               ;\n"
        "    local          2001:19f0:ac00:4406:5400:05ff:fee9:27e6 as 4288000334 ;\n"
        "    description    \"ideanet\" ;\n"
        "protocol bgp vultr {\n"
        "\n"
        "protocol kernel { ipv6 { export all ; } ; }\n"
        "\n"
        "debug protocols all ;\n"
        "\n"
        "router id 149.28.204.105 ;\n"
        "\n"
        "log \"/tmp/bird.log\" all ;\n"
        "\n"

    TN( tImage1 ,

    etherC& etRock = etherC::etRockIF( tin0P ) ;
{
if( pTaskP )
TASK( tmWorkF )

/*1*/WAKEhIDE( "ifcIDaDAM_IDEAnETcONTROLrOUTER" )/*1*/
/**/
*/
/*

//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 33 years.
//
// Copyright (c) 1992-2025 Wo Of Ideafarm.  All rights reserved.  See https://github.com/ideafarm/ideafarm.home.1 for permitted uses.
//
