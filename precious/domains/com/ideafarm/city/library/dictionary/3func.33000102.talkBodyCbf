
//
// Copyright (c) 1992-2024 Wo Of Ideafarm.  All rights reserved.  See https://github.com/ideafarm/ideafarm.home.1 for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 33 years.
// Respecting the rights of other people is an important part of empowering one another.
//


}
    //etThread.traceF( tin0P , T("talkBodyCBF / 0") ) ; //U:: TO FIND A BUG
    }
        etThread.traceF( tin0P , T("talkBodyCBF / updated swMapUrl [tUrlNew]:    ")+tUrlNew ) ;
        etThread.traceF( tin0P , T("talkBodyCBF / updated swMapUrl [tUrlOld]:    ")+tUrlOld ) ;

        swMapUrl.ungrabF( tin0P ) ;

        etThread.strMakeF( tin0P , LF , psttUrlNew , tUrlNew ) ; ___( psttUrlNew ) ;
        etThread.delF( tin0P , psttUrlNew ) ;
        strokeS*& psttUrlNew = *(strokeS**)&(countT&)swMapUrl ;
        psttLeverUrl = tUrlOld ;

        swMapUrl.grabF( tin0P , TAG( TAGiDnULL ) ) ;

        TN( tUrlNew , "" ) ; tUrlNew = T(psttNameP)+T("?secretisok=yes") ;
        TN( tUrlOld , "" ) ; tUrlOld = T(psttNameP)+T("?")+T(psttQueryKVP) ;

        switchC&  swMapUrl     = meP.swMapUrlF() ;
        strokeS*& psttLeverUrl = meP.psttLeverUrlMapF() ;

        replyP.idSnipHttpLocation = ifcIDsNIPpREDEFINED_REDIRECTlOCATIONtALKbODY ;
        replyP.idSnipHttpPrefix   = ifcIDsNIPpREDEFINED_HTTPfAILmOVED            ;
    {
    if( tValueSelectTopicShort.csF( tin0P ) ) //DO THIS IFF AM RESPONDING TO A FORM (IT DOES NOT WORK WITH FIREFOX.  THE GOAL WAS TO PREVENT BROWSER FROM REPEATEDLY RESENDING THE QUERY, WHICH INTERFERES WITH CACHEING)
    //etThread.traceF( tin0P , T("talkBodyCBF / 1") ) ; //U:: TO FIND A BUG

    }
        }
            etThread.traceF( tin0P , T("disk or file error 13") ) ;
            POOPR
        {
        if( POOP )

        }
            etThread.delF( tin0P , psttShort ) ;

            DEL( prPosts ) ;
            if( prPosts ) meP.pushSnipF( tin0P , stBodyP , *prPosts ) ;
            etThread.strMakeF( tin0P , LF , prPosts , T("<p>\r\n")+tOut+T("\r\n") , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
            ZE( pbRefC* , prPosts ) ;

            TN( tOut , "" ) ; tOut = T("<span style=\"color:Cyan ; font-size: 0.5em ;\">")+tSaidTimeForeign+tb4+tSaidCountryCode+tb4+tSaidZipUse+tb4+tSaidCity+tb4+tSaidIdSubscriber0+tb4+tSaidFirstName+tb4+tSaidLastName+tOutFlags+T(": </span>")+tSaidSpeech ;

            if( !etThread.strCompareF( tin0P , tSaidFlags , T("anonymous") ) ) tOutFlags = T(" (anonymous) ") ;
            TN( tOutFlags , "" ) ;

            }
                etThread.traceF( tin0P , T("disk or file error 58") ) ;
                POOPR
            {
            if( POOP )

            }
                }
                    //etThread.traceF( tin0P , T("talkBodyCBF / 2.0") ) ; //U:: TO FIND A BUG
                    etThread.delF( tin0P , psttSaidCountryCode ) ;
                    tSaidCountryCode = T(psttSaidCountryCode) ;
                    said >> psttSaidCountryCode ; ___( psttSaidCountryCode ) ;
                    ZE( strokeS* , psttSaidCountryCode ) ;

                    etThread.delF( tin0P , psttSaidState ) ;
                    said >> psttSaidState ; ___( psttSaidState ) ;
                    ZE( strokeS* , psttSaidState ) ;

                    etThread.delF( tin0P , psttSaidCity ) ;
                    tSaidCity = T(psttSaidCity) ;
                    said >> psttSaidCity ; ___( psttSaidCity ) ;
                    ZE( strokeS* , psttSaidCity ) ;

                    etThread.delF( tin0P , psttSaidAddressStreet ) ;
                    said >> psttSaidAddressStreet ; ___( psttSaidAddressStreet ) ;
                    ZE( strokeS* , psttSaidAddressStreet ) ;

                    said >> nnPeer ;
                    nicNameC nnPeer ;

                    etThread.delF( tin0P , psttSaidNnPeer ) ;
                    said >> psttSaidNnPeer ; ___( psttSaidNnPeer ) ;
                    ZE( strokeS* , psttSaidNnPeer ) ;

                    etThread.delF( tin0P , psttSaidZipUse ) ;
                    tSaidZipUse = T(psttSaidZipUse) ;
                    said >> psttSaidZipUse ; ___( psttSaidZipUse ) ;
                    ZE( strokeS* , psttSaidZipUse ) ;

                    etThread.delF( tin0P , psttSaidAddressName ) ;
                    said >> psttSaidAddressName ; ___( psttSaidAddressName ) ;
                    ZE( strokeS* , psttSaidAddressName ) ;

                    etThread.delF( tin0P , psttSaidLastName ) ;
                    tSaidLastName = T(psttSaidLastName) ;
                    said >> psttSaidLastName ; ___( psttSaidLastName ) ;
                    ZE( strokeS* , psttSaidLastName ) ;

                    //etThread.traceF( tin0P , T("talkBodyCBF: tSaidFirstName: ")+tSaidFirstName ) ; //U::
                    etThread.delF( tin0P , psttSaidFirstName ) ;
                    tSaidFirstName = T(psttSaidFirstName) ;
                    said >> psttSaidFirstName ; ___( psttSaidFirstName ) ;
                    ZE( strokeS* , psttSaidFirstName ) ;

                    etThread.delF( tin0P , psttSaidPaypalPayerEmail ) ;
                    said >> psttSaidPaypalPayerEmail ; ___( psttSaidPaypalPayerEmail ) ;
                    ZE( strokeS* , psttSaidPaypalPayerEmail ) ;

                    etThread.delF( tin0P , psttSaidIdSubscriber0 ) ;
                    tSaidIdSubscriber0 = T(psttSaidIdSubscriber0) ;
                    said >> psttSaidIdSubscriber0 ; ___( psttSaidIdSubscriber0 ) ;
                    ZE( strokeS* , psttSaidIdSubscriber0 ) ;

                    etThread.delF( tin0P , psttSpeechClean ) ;
                    tSaidSpeech = T(psttSpeechClean) ;
                    said >> psttSpeechClean ; ___( psttSpeechClean ) ;
                    ZE( strokeS* , psttSpeechClean ) ;

                    etThread.delF( tin0P , psttValueSpeech ) ;
                    said >> psttValueSpeech ; ___( psttValueSpeech ) ;
                    ZE( strokeS* , psttValueSpeech ) ;

                    }
                        etThread.delF( tin0P , psttFlags ) ;
                        tSaidFlags = T(psttFlags) ;
                        said >> psttFlags ; ___( psttFlags ) ;
                        ZE( strokeS* , psttFlags ) ;
                    {
                    if( idFormat >= 4 )

                    etThread.delF( tin0P , psttTimeForeign ) ;
                    tSaidTimeForeign = T(psttTimeForeign) ;
                    said >> psttTimeForeign ; ___( psttTimeForeign ) ;
                    ZE( strokeS* , psttTimeForeign ) ;

                    said >> *(countT*)&timeS2 ;
                    ZE( sCountT , timeS2 ) ;

                    said >> timeS1 ;
                    ZE( countT , timeS1 ) ;

                    said >> idFormat ;
                    ZE( countT , idFormat ) ;

                    said >> finger ;
                    ZE( countT , finger ) ;
                    //etThread.traceF( tin0P , T("talkBodyCBF / 2.1") ) ; //U:: TO FIND A BUG
                {
                else
                }
                    etThread.traceF( tin0P , T("disk or file error 149") ) ;
                    POOPR
                {
                if( POOP )

                ((tin1S&)tin0P).pEtScratch->boxGetShadowF( tin0P , said , tListSaidFile , 1 ) ;
                soulC said( tin0P , *((tin1S&)tin0P).pEtScratch , TAG( TAGiDnULL ) ) ;
                //etThread.traceF( tin0P , T("talkBodyCBF / 2.2") ) ; //U:: TO FIND A BUG
            {
            TN( tSaidFlags , "" ) ;
            TN( tSaidCountryCode , "" ) ;
            TN( tSaidCity , "" ) ;
            TN( tSaidZipUse , "" ) ;
            TN( tSaidLastName , "" ) ;
            TN( tSaidFirstName , "" ) ;
            TN( tSaidIdSubscriber0 , "" ) ;
            TN( tSaidSpeech , "" ) ;
            TN( tSaidTimeForeign , "" ) ;
            //etThread.traceF( tin0P , T("talkBodyCBF / 2.3") ) ; //U:: TO FIND A BUG

            }
                TlISTlOAD( tListSaidFile , meP.tListFactoryF() , tSuffix ) ;
                TN( tSuffix , "" ) ; tSuffix = T("d/ideafarm.home.101/ephemeral/backed.up.daily/domains/com/ideafarm/wo.o.s.table/said/")+T(psttShort) ;
            {
            TlIST( tListSaidFile ) ;

            stFileShortSaid >> psttShort ;
            ZE( strokeS* , psttShort ) ;
            //etThread.traceF( tin0P , T("talkBodyCBF / 2.4") ) ; //U:: TO FIND A BUG
        {
        while( stFileShortSaid )
        TN( tb4 , "    " ) ;

        SCOOPS
    {
    IFsCRATCHoK
    //etThread.traceF( tin0P , T("talkBodyCBF / 2") ) ; //U:: TO FIND A BUG

    }
        }
            }
                }
                    etThread.traceF( tin0P , T("disk or file error 137") ) ;
                    POOPR
                {
                if( POOP )

                }
                    etThread.delF( tin0P , psttShort ) ;

                    DEL( prPosts ) ;
                    if( prPosts ) meP.pushSnipF( tin0P , stBodyP , *prPosts ) ;
                    etThread.strMakeF( tin0P , LF , prPosts , T("<p>\r\n")+tOut+T("\r\n") , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
                    ZE( pbRefC* , prPosts ) ;

                    ) ;

                        "</table>\r\n"
                            "</tr>\r\n"
                                "</td>\r\n"
                                    )+tPTopicTopic+T(
                                "<td>\r\n"
                                "</td>\r\n"
                                    "</script>\r\n"
                                        "document.getElementById( 'secret' ).innerHTML = window.parent.document.getElementById( 'hiddensecret' ).innerHTML ;\r\n"
                                        "document.getElementById( 'subscriberid'   ).innerHTML = window.parent.document.getElementById( 'hiddensubscriberid' ).innerHTML ;\r\n"
                                    "<script>\r\n"
                                    "</form>\r\n"
                                        "<input id=\"submit\" name=\"submit\" type=\"submit\" value=\"Change Topic\" onclick=\" window.parent.document.getElementById( 'showtopic' ).innerHTML = '")+tPTopicTopic+T("' ; \"/>\r\n"
                                        "<input id=\"newtopic\" name=\"newtopic\" type=\"hidden\" value=\"")+tPTopicTopic+T("\"/>\r\n"
                                        "<input id=\"secret\" name=\"secret\" type=\"hidden\" value=\"\"/>\r\n"
                                        "<input id=\"subscriberid\" name=\"subscriberid\" type=\"hidden\" value=\"\"/>\r\n"
                                        "<input id=\"filenametopic\" name=\"filenametopic\" type=\"hidden\" value=\"")+T(psttShort)+T("\"/>\r\n"
                                    "<form action=\"https://")+T(bSandbox?postCRAFTWORKfACTORY".":"")+T("ideafarm.com/talk.body\" id=\"launchtopic\" method=\"get\" name=\"launchtopic\">\r\n"
                                "<td valign=\"center\">\r\n"
                            "<tr>\r\n"
                        "<table>\r\n"
                        "<p>\r\n"

                    TN( tOut , "" ) ; tOut = T(

                    //if( !((tin1S&)tin0P).pEtScratch->strCompareF( tin0P , tPTopicFlags , T("anonymous") ) ) tOutFlags = T(" (anonymous) ") ; // FOR FUTURE USE.  CURRENT CODE DOES NOT SUPPORT ANONYMOUS TOPIC PROPOSALS
                    //TN( tOutFlags , "" ) ;

                    }
                        etThread.traceF( tin0P , T("disk or file error 227") ) ;
                        POOPR
                    {
                    if( POOP )

                    }
                        }
                            etThread.delF( tin0P , psttSaidCountryCode ) ;
                            tPTopicCountryCode = T(psttSaidCountryCode) ;
                            said >> psttSaidCountryCode ; ___( psttSaidCountryCode ) ;
                            ZE( strokeS* , psttSaidCountryCode ) ;

                            etThread.delF( tin0P , psttSaidState ) ;
                            said >> psttSaidState ; ___( psttSaidState ) ;
                            ZE( strokeS* , psttSaidState ) ;

                            etThread.delF( tin0P , psttSaidCity ) ;
                            tPTopicCity = T(psttSaidCity) ;
                            said >> psttSaidCity ; ___( psttSaidCity ) ;
                            ZE( strokeS* , psttSaidCity ) ;

                            etThread.delF( tin0P , psttSaidAddressStreet ) ;
                            said >> psttSaidAddressStreet ; ___( psttSaidAddressStreet ) ;
                            ZE( strokeS* , psttSaidAddressStreet ) ;

                            said >> nnPeer ;
                            nicNameC nnPeer ;

                            etThread.delF( tin0P , psttSaidNnPeer ) ;
                            said >> psttSaidNnPeer ; ___( psttSaidNnPeer ) ;
                            ZE( strokeS* , psttSaidNnPeer ) ;

                            etThread.delF( tin0P , psttSaidZipUse ) ;
                            tPTopicZipUse = T(psttSaidZipUse) ;
                            said >> psttSaidZipUse ; ___( psttSaidZipUse ) ;
                            ZE( strokeS* , psttSaidZipUse ) ;

                            etThread.delF( tin0P , psttSaidAddressName ) ;
                            said >> psttSaidAddressName ; ___( psttSaidAddressName ) ;
                            ZE( strokeS* , psttSaidAddressName ) ;

                            etThread.delF( tin0P , psttSaidLastName ) ;
                            tPTopicLastName = T(psttSaidLastName) ;
                            said >> psttSaidLastName ; ___( psttSaidLastName ) ;
                            ZE( strokeS* , psttSaidLastName ) ;

                            etThread.delF( tin0P , psttSaidFirstName ) ;
                            tPTopicFirstName = T(psttSaidFirstName) ;
                            said >> psttSaidFirstName ; ___( psttSaidFirstName ) ;
                            ZE( strokeS* , psttSaidFirstName ) ;

                            etThread.delF( tin0P , psttSaidPaypalPayerEmail ) ;
                            said >> psttSaidPaypalPayerEmail ; ___( psttSaidPaypalPayerEmail ) ;
                            ZE( strokeS* , psttSaidPaypalPayerEmail ) ;

                            etThread.delF( tin0P , psttSaidIdSubscriber0 ) ;
                            tPTopicIdSubscriber0 = T(psttSaidIdSubscriber0) ;
                            said >> psttSaidIdSubscriber0 ; ___( psttSaidIdSubscriber0 ) ;
                            ZE( strokeS* , psttSaidIdSubscriber0 ) ;

                            etThread.delF( tin0P , psttTopicClean ) ;
                            tPTopicTopic = T(psttTopicClean) ;
                            said >> psttTopicClean ; ___( psttTopicClean ) ;
                            ZE( strokeS* , psttTopicClean ) ;

                            etThread.delF( tin0P , psttValueTopic ) ;
                            said >> psttValueTopic ; ___( psttValueTopic ) ;
                            ZE( strokeS* , psttValueTopic ) ;

                            }
                                etThread.delF( tin0P , psttFlags ) ;
                                tPTopicFlags = T(psttFlags) ;
                                said >> psttFlags ; ___( psttFlags ) ;
                                ZE( strokeS* , psttFlags ) ;
                            {
                            if( idFormat >= 4 )

                            etThread.delF( tin0P , psttTimeForeign ) ;
                            tPTopicTimeForeign = T(psttTimeForeign) ;
                            said >> psttTimeForeign ; ___( psttTimeForeign ) ;
                            ZE( strokeS* , psttTimeForeign ) ;

                            said >> *(countT*)&timeS2 ;
                            ZE( sCountT , timeS2 ) ;

                            said >> timeS1 ;
                            ZE( countT , timeS1 ) ;

                            said >> idFormat ;
                            ZE( countT , idFormat ) ;

                            said >> finger ;
                            ZE( countT , finger ) ;
                        {
                        else
                        }
                            etThread.traceF( tin0P , T("disk or file error 315") ) ;
                            POOPR
                        {
                        if( POOP )

                        ((tin1S&)tin0P).pEtScratch->boxGetShadowF( tin0P , said , tListSelectTopicLong , 1 ) ;
                        soulC said( tin0P , *((tin1S&)tin0P).pEtScratch , TAG( TAGiDnULL ) ) ;
                    {
                    TN( tPTopicFlags , "" ) ;
                    TN( tPTopicCountryCode , "" ) ;
                    TN( tPTopicCity , "" ) ;
                    TN( tPTopicZipUse , "" ) ;
                    TN( tPTopicLastName , "" ) ;
                    TN( tPTopicFirstName , "" ) ;
                    TN( tPTopicIdSubscriber0 , "" ) ;
                    TN( tPTopicTopic , "" ) ;
                    TN( tPTopicTimeForeign , "" ) ;

                    }
                        TlISTlOAD( tListSelectTopicLong , meP.tListFactoryF() , tSuffix ) ;
                        TN( tSuffix , "" ) ; tSuffix = T("d/ideafarm.home.101/ephemeral/backed.up.daily/domains/com/ideafarm/wo.o.s.table/ptopic/")+T(psttShort) ;
                    {
                    TlIST( tListSelectTopicLong ) ;

                    stFilePTopic >> psttShort ;
                    ZE( strokeS* , psttShort ) ;
                {
                while( stFilePTopic )
                TN( tb4 , "    " ) ;

                }
                    while( ~hFind && !POOP ) ;
                    }
                        DEL( pInfo ) ;
                        }
                            if( !ids ) etThread.delF( tin0P , psttShort ) ;
                            stFilePTopic.sinkF( tin0P , ids , psttShort , flSTACKsINK_UNIQUE ) ;
                            ZE( countT , ids ) ;

                            }
                                etThread.delF( tin0P , psttnu ) ;
                                etThread.strBisectF( tin0P , psttnu , psttShort , pInfo->psttIfoName , T("/") , - 1 , flSTRbISECT_APPENDdELIMITER ) ; ___( psttnu ) ; ___( psttShort ) ;
                                ZE( strokeS* , psttnu ) ;
                            {
                            ZE( strokeS* , psttShort ) ;
                        {
                        else
                        }
                            break ;
                            DEL( pInfo ) ;
                        {
                        else if( !pInfo || !pInfo->psttIfoName )
                        }
                            etThread.traceF( tin0P , T("disk or file error 295") ) ;
                            POOPR
                        {
                        if( POOP )

                        ((tin1S&)tin0P).pEtScratch->diskFindFileOrDirF( tin0P , pInfo , hFind , psttc1 , &pat ) ;
                        ZE( infoFileS* , pInfo ) ;
                    {
                    do
                    handleC hFind( tin0P , TAG( TAGiDnULL ) , ifcIDtYPEhANDLE_FILEfIND ) ;
                {
                FORsTRINGSiN1( (strokeS*)tListPTopicPath )
                stackC stFilePTopic( tin0P , *((tin1S&)tin0P).pEtScratch , TAG( TAGiDnULL ) , flSTACKc_DOnOTsERIALIZE | flSTACKc_SINKrEVERSE , ifcSTACKtYPE_PTR_strokeS , ifcIDgRABlAYER_7BASEmISC1 ) ;

                }
                    TlISTlOAD( tListPTopicPath , meP.tListFactoryF() , tSuffix ) ;
                    TN( tSuffix , "d/ideafarm.home.101/ephemeral/backed.up.daily/domains/com/ideafarm/wo.o.s.table/ptopic/" ) ;
                {
                TlIST( tListPTopicPath ) ;

                patternC pat( tin0P , *((tin1S&)tin0P).pEtScratch , tPattern , ifcIDtYPEpATTERN_FOREIGNwILDCARDsTRICT ) ;
                TN( tPattern , "" ) ; tPattern = T("ptopic.table")+T(bSandbox?".sandbox.*":".live.*") ;

                SCOOPS
            {
            IFsCRATCHoK
        {
        if( bDadSecretIsOk || bSecretIsOK /*&& !bTopicIsFresh*/ ) // bTopicIsFresh IS NOT SET (FOR SPEED, TO AVOID DISK READS), SO I CAN'T CHECK IT HERE

        /***************************************************************************************************/
        /***************************************************************************************************/
        /***************************************************************************************************/
        /****                                                                                           ****/
        /****  2:  DISPLAY FORM TO SELECT EACH PROPOSED TOPIC                                           ****/
        /****                                                                                           ****/
        /***************************************************************************************************/
        /***************************************************************************************************/
        /***************************************************************************************************/

        //}
        //    DEL( prPosts ) ;
        //    if( prPosts ) meP.pushSnipF( tin0P , stBodyP , *prPosts ) ;
        //
        //    etThread.strMakeF( tin0P , LF , prPosts , tSay , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
        //    ZE( pbRefC* , prPosts ) ;
        //
        //    ) ;
        //
        //        "<p>\r\n"
        //        "</form>\r\n"
        //            "<input id=\"submit\" name=\"submit\" type=\"submit\" value=\"Please click.\"/>\r\n"
        //            "<input id=\"secretisok\" name=\"secretisok\" type=\"hidden\" value=\"yes\"/>\r\n"
        //        "<form action=\"https://")+T(bSandbox?postCRAFTWORKfACTORY".":"")+T("ideafarm.com/talk.body\" id=\"fixit\" method=\"get\" name=\"fixit\">\r\n"
        //        "<p>\r\n"
        //
        //    TN( tSay , "" ) ; tSay = T(
        //{
        //if( !tValueDadSecretIsOk.csF( tin0P ) )  //CS:CODEsYNC: DUPLICATE 33000102 33000102
        //THIS IS A WORKAROUND TO UNDESIRABLE BROWSER BEHAVIOR, BUT IT MIGHT NOT BE REALLY NEEDED.  (SEE THE REQUEST QUERY STRING for /talk.body)

        }
            if( POOP ) POOPR

            }
                while( ~hFind && !POOP ) ;
                }
                    DEL( pInfo ) ;
                    }
                        }
                            //etThread.traceF( tin0P , T("disk or file error 427") ) ;
                            POOPRqUIET ;
                        {
                        if( POOP )
                        ((tin1S&)tin0P).pEtScratch->diskFileOrDirDeleteF( tin0P , pInfo->psttIfoName , flFILEoRdIRdELETE_null , 1 ) ;
                    {
                    else
                    }
                        break ;
                        DEL( pInfo ) ;
                    {
                    else if( !pInfo || !pInfo->psttIfoName )
                    }
                        //etThread.traceF( tin0P , T("disk or file error 337") ) ;
                        POOPRqUIET
                    {
                    if( POOP )

                    ((tin1S&)tin0P).pEtScratch->diskFindFileOrDirF( tin0P , pInfo , hFind , psttc1 , &pat ) ;
                    ZE( infoFileS* , pInfo ) ;
                {
                do
                handleC hFind( tin0P , TAG( TAGiDnULL ) , ifcIDtYPEhANDLE_FILEfIND ) ;
            {
            FORsTRINGSiN1( (strokeS*)tListPath )

            }
                TlISTlOAD( tListPath , meP.tListFactoryF() , tSuffix ) ;
                TN( tSuffix , "d/ideafarm.home.101/ephemeral/backed.up.daily/domains/com/ideafarm/wo.o.s.table/newTopic/" ) ;
            {
            TlIST( tListPath ) ;

            patternC pat( tin0P , *((tin1S&)tin0P).pEtScratch , tPattern , ifcIDtYPEpATTERN_FOREIGNwILDCARDsTRICT ) ;
            TN( tPattern , "" ) ; tPattern = T("newTopic")+T(bSandbox?".sandbox.*":".live.*") ;

            SCOOPS
        {
        IFsCRATCHoK

        }
            DEL( prPosts ) ;
            if( prPosts ) meP.pushSnipF( tin0P , stBodyP , *prPosts ) ;

            etThread.strMakeF( tin0P , LF , prPosts , tSay , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
            ZE( pbRefC* , prPosts ) ;

            TN( tSay , "" ) ; tSay = T("<script> window.parent.document.getElementById( 'showtopic' ).innerHTML = 'Open!' ; </script>\r\n<p>\r\n") ;

            countT secondsRemaining = 60 * minAllowed - allSeconds ;
            countT allSeconds = seconds + minutes * 60 ;

        {
    {
    else
    }
        //}
        //    DEL( prPosts ) ;
        //    if( prPosts ) meP.pushSnipF( tin0P , stBodyP , *prPosts ) ;
        //
        //    etThread.strMakeF( tin0P , LF , prPosts , tSay , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
        //    ZE( pbRefC* , prPosts ) ;
        //
        //    ) ;
        //
        //        "<p>\r\n"
        //        "</form>\r\n"
        //            "<input id=\"submit\" name=\"submit\" type=\"submit\" value=\"Please click.\"/>\r\n"
        //            "<input id=\"secretisok\" name=\"secretisok\" type=\"hidden\" value=\"yes\"/>\r\n"
        //        "<form action=\"https://")+T(bSandbox?postCRAFTWORKfACTORY".":"")+T("ideafarm.com/talk.body\" id=\"fixit\" method=\"get\" name=\"fixit\">\r\n"
        //        "<p>\r\n"
        //
        //    TN( tSay , "" ) ; tSay = T(
        //{
        //if( !tValueDadSecretIsOk.csF( tin0P ) )  //CS:CODEsYNC: DUPLICATE 33000102 33000102
        //THIS IS A WORKAROUND TO UNDESIRABLE BROWSER BEHAVIOR, BUT IT MIGHT NOT BE REALLY NEEDED.  (SEE THE REQUEST QUERY STRING for /talk.body)

        }
            DEL( prPosts ) ;
            if( prPosts ) meP.pushSnipF( tin0P , stBodyP , *prPosts ) ;

            etThread.strMakeF( tin0P , LF , prPosts , tSay , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
            ZE( pbRefC* , prPosts ) ;

            ) ;

                "</script>\r\n"
                    "document.getElementById( 'currenttopic' ).innerHTML = window.parent.document.getElementById( 'showtopic' ).innerHTML ;\r\n"
                "<script>\r\n"
                "<span id=\"topiccountdown\">: Topic is now <span id=\"currenttopic\" style=\"color:cyan\"></span> and will become unlocked in ")+TF4(secondsRemaining,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_FOREIGN|flFORMAT_NObASE,0,0xa)+T(" seconds.</span>\r\n<p>\r\n"

            TN( tSay , "" ) ; tSay = T(

            countT secondsRemaining = 60 * minAllowed - allSeconds ;
            countT allSeconds = seconds + minutes * 60 ;
        {
    {
    if( cFiles && !years && !months && !days && !hours && minutes < minAllowed )
    const countT minAllowed = 1 ; // 2 IN PRODUCTION

    if( cFiles ) etThread.osTimeToOldTimeF( tin0P , countTC() , seconds , minutes , hours , days , months , years , countTC() , timeA1 , timeA2 , flOStIMEfROMoLDtIME_OLDtIMEiSutc ) ;
    ZE( sCountT , years   ) ;
    ZE( countT  , months  ) ;
    ZE( countT  , days    ) ;
    ZE( countT  , hours   ) ;
    ZE( countT  , minutes ) ;
    ZE( countT  , seconds ) ;

    //etThread.traceF( tin0P , T("age of youngest post: ")+TT(timeA1,timeA2) ) ;
    }
        if( POOP ) POOPR

        }
            while( ~hFind && !POOP ) ;
            }
                DEL( pInfo ) ;
                }
                    if( !ids ) etThread.delF( tin0P , psttShort ) ;
                    stFileShortSaid.sinkF( tin0P , ids , psttShort , flSTACKsINK_UNIQUE ) ;
                    ZE( countT , ids ) ;

                    }
                        etThread.delF( tin0P , psttnu ) ;
                        etThread.strBisectF( tin0P , psttnu , psttShort , pInfo->psttIfoName , T("/") , - 1 , flSTRbISECT_APPENDdELIMITER ) ; ___( psttnu ) ; ___( psttShort ) ;
                        ZE( strokeS* , psttnu ) ;
                    {
                    ZE( strokeS* , psttShort ) ;

                    }
                        timeA2 = timeE2 ;
                        timeA1 = timeE1 ;
                    {
                    if( timeA2 > timeE2 || timeA1 > timeE1 )
                    //etThread.traceF( tin0P , T("age: ")+TT(timeE1,timeE2) ) ;
                    etThread.osTimeSubtractF( tin0P , timeE1 , timeE2 , pInfo->timeCreated1 , pInfo->timeCreated2 ) ;
                    sCountT timeE2 = timeN2 ;
                    countT  timeE1 = timeN1 ;
                    cFiles ++ ;
                {
                else
                }
                    break ;
                    DEL( pInfo ) ;
                {
                else if( !pInfo || !pInfo->psttIfoName )
                }
                    //etThread.traceF( tin0P , T("disk or file error 425") ) ;
                    POOPRqUIET
                {
                if( POOP )

                ((tin1S&)tin0P).pEtScratch->diskFindFileOrDirF( tin0P , pInfo , hFind , psttc1 , &pat ) ;
                ZE( infoFileS* , pInfo ) ;
            {
            do
            handleC hFind( tin0P , TAG( TAGiDnULL ) , ifcIDtYPEhANDLE_FILEfIND ) ;
            patternC pat( tin0P , *((tin1S&)tin0P).pEtScratch , tPattern , ifcIDtYPEpATTERN_FOREIGNwILDCARDsTRICT ) ;
            TN( tPattern , "" ) ; tPattern = T("said.table")+T(bSandbox?".sandbox.*":".live.*") ;
        {
        FORsTRINGSiN1( (strokeS*)tListSaidPath )

        SCOOPS
    {
    IFsCRATCHoK
    ZE( countT , cFiles ) ;
    sCountT timeA2 = MAXscOUNTT ; // AGE OF THE YOUNGEST POST
    countT  timeA1 = MAXcOUNTT  ; // AGE OF THE YOUNGEST POST ; "A": "AGE"
    stackC stFileShortSaid( tin0P , etThread , TAG( TAGiDnULL ) , flSTACKc_DOnOTsERIALIZE | flSTACKc_SINKrEVERSE , ifcSTACKtYPE_PTR_strokeS , ifcIDgRABlAYER_7BASEmISC1 ) ;
    //etThread.traceF( tin0P , T("talkBodyCBF / 3") ) ; //U:: TO FIND A BUG

    }
        TlISTlOAD( tListSaidPath , meP.tListFactoryF() , tSuffix ) ;
        TN( tSuffix , "d/ideafarm.home.101/ephemeral/backed.up.daily/domains/com/ideafarm/wo.o.s.table/said/" ) ;
    {
    TlIST( tListSaidPath ) ;

    }
        DEL( prPosts ) ;
        if( prPosts ) meP.pushSnipF( tin0P , stBodyP , *prPosts ) ;

        etThread.strMakeF( tin0P , LF , prPosts , tSay , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
        ZE( pbRefC* , prPosts ) ;

        TN( tSay , "" ) ; tSay = tTimeForeign + tSuffix ;

        textC tTimeForeign( ifcIDtEXTgEN_TIMEnOWfOREIGN , tin0P , TAG( TAGiDnULL ) ) ;

        TN( tSuffix , "" ) ; tSuffix = tb4+tHost+tb4+TF2(idIn,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED) ;   //U:: THIS IS FOR DEBUGGING ; REMOVE AFTER DEVELOPMENT
        TN( tb4 , "    " ) ;
        countT idIn = 1 + incv02AM( idInLath ) ;
        static countT idInLath ;

        }
            if( !tHost.csF( tin0P ) ) tHost = T("factories") ;
            etThread.delF( tin0P , psttHost ) ;
            else            tHost = T(psttHost) ;
            if( !psttHost ) etThread.traceF( tin0P , T("error: reverse DNS lookup on myself failed") ) ;
            etThread.sockPsttHostF( tin0P , psttHost ) ; ___( psttHost ) ;
            ZE( strokeS* , psttHost ) ;
        {
        TN( tHost , "" ) ;
    {

    etThread.osTimeNowF( tin0P , timeN1 , timeN2 ) ;
    ZE( sCountT , timeN2 ) ;
    ZE( countT , timeN1 ) ;

    meP.pushSnipF( tin0P , stBodyP , ifcIDsNIPpREDEFINED_BODYrAWbEGIN ) ;
    meP.pushSnipF( tin0P , stBodyP , ifcIDsNIPpREDEFINED_HEADrAW5hEADeND ) ;
    meP.pushSnipF( tin0P , stBodyP , ifcIDsNIPpREDEFINED_HEADrAW4sCRIPTeND ) ;
    meP.pushSnipF( tin0P , stBodyP , ifcIDsNIPpREDEFINED_HEADrAW3sCRIPTbEGIN ) ;

    }
        DEL( prPosts ) ;
        if( prPosts ) meP.pushSnipF( tin0P , stBodyP , *prPosts ) ;

        etThread.strMakeF( tin0P , LF , prPosts , tSay , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
        ZE( pbRefC* , prPosts ) ;

        TN( tSay , "<meta http-equiv=\"refresh\" content=\"2\"/>\r\n" ) ;
    {

    meP.pushSnipF( tin0P , stBodyP , ifcIDsNIPpREDEFINED_HEADrAW2aFTERtITLE ) ;
    }
        DEL( prPosts ) ;
        if( prPosts ) meP.pushSnipF( tin0P , stBodyP , *prPosts ) ;

        etThread.strMakeF( tin0P , LF , prPosts , tSay , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
        ZE( pbRefC* , prPosts ) ;

        TN( tSay , "Wo'O's Table (tm)\r\n" ) ;
    {
    meP.pushSnipF( tin0P , stBodyP , ifcIDsNIPpREDEFINED_HEADrAW1bEFOREtITLE ) ;
    //etThread.traceF( tin0P , T("talkBodyCBF / 4") ) ; //U:: TO FIND A BUG

    }
        }
            THREADmODE1rESTORE

            etThread.boxPutF( tin0P , T("smtp.mailgun.org[admin]/b42/smtp/")+tHost+T("@ideafarm.com/")+tToUse+T("//wo@ideafarm.com/ideafarm.factory.reports@gmail.com") , tBody ) ;

            ;
                : tLoginPaypalPayerEmail
                ? tEmailSandboxMe
            textC& tToUse = bSandbox
            TN( tEmailSandboxMe , "ideafarmcity@gmail.com" ) ;

            tBody += T("time:  ")+tTimeForeign+T("\r\n") ;
            tBody += T("\r\nreference:  ")+tShort+T("\r\n") ;
            tBody += T("your selected new topic:\r\n\r\n")+tNewTopic+T("\r\n\r\n") ;

            }
                ) ;

                    "\r\n"
                    "\r\n"
                    "Subject: Wo'O's Table:  You just set this new topic on Wo'O's Table Talk.\r\n"

                tBody = T(
            {
            else
            }
                ) ;

                    "\r\n"
                    "\r\n"
                    "Subject: Wo'O's Table:  Oops!  I could not process your new topic on Wo'O's Table Talk.\r\n"

                tBody = T(
            {
            if( bFail )
            TN( tBody , "" ) ;

            }
                }
                    etThread.delF( tin0P , psttFile ) ;
                    etThread.delF( tin0P , psttShort ) ;
                    etThread.delF( tin0P , psttnu ) ;
                    tShort = T(psttShort) ;
                    etThread.strBisectF( tin0P , psttnu , psttShort , psttFile , T("/") , - 1 , flSTRbISECT_APPENDdELIMITER ) ; ___( psttnu ) ; ___( psttShort ) ;
                    ZE( strokeS* , psttShort ) ;
                    ZE( strokeS* , psttnu ) ;

                    //}
                    //    //etThread.traceF( tin0P , T("wrote   ")+T(psttFile) ) ;
                    //{
                    //FORsTRINGSiN1( psttFile )
                {
                else
                }
                    bFail |= 2 ;
                    etThread.traceF( tin0P , T("disk or file error 517") ) ;
                    POOPR
                {
                if( POOP )

                ((tin1S&)tin0P).pEtScratch->boxPutUniqueF( tin0P , psttFile , tList , WS( newTopic ) ) ; ___( psttFile ) ;
                ZE( strokeS* , psttFile ) ;

                }
                    TlISTlOAD( tList , meP.tListFactoryF() , tSuffix ) ;
                    TN( tSuffix , "" ) ; tSuffix = T("d/ideafarm.home.101/ephemeral/backed.up.daily/domains/com/ideafarm/wo.o.s.table/newTopic/newTopic")+T(bSandbox?".sandbox.@1@.":".live.@1@.")+T(nnPeerP)+tDot+TF4(((countT*)&subscriberIdTry)[0],flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_NObASE,0,0x3e)+tDot+TF4(((countT*)&subscriberIdTry)[1],flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_NObASE,0,0x3e)+tDot+tHost ;
                {
                TlIST( tList ) ;
            {
            IFsCRATCHoK
            TN( tShort , "" ) ;

            }
                etThread.delF( tin0P , psttFile ) ;

                }
                    //}
                    //    //etThread.traceF( tin0P , T("wrote   ")+T(psttFile) ) ;
                    //{
                    //FORsTRINGSiN1( psttFile )
                {
                else
                }
                    bFail |= 1 ;
                    etThread.traceF( tin0P , T("disk or file error 526") ) ;
                    POOPR
                {
                if( POOP )

                ((tin1S&)tin0P).pEtScratch->boxPutUniqueF( tin0P , psttFile , tList , WS( said ) ) ; ___( psttFile ) ;
                ZE( strokeS* , psttFile ) ;

                }
                    TlISTlOAD( tList , meP.tListFactoryF() , tSuffix ) ;
                    TN( tSuffix , "" ) ; tSuffix = T("d/ideafarm.home.101/ephemeral/backed.up.daily/domains/com/ideafarm/wo.o.s.table/said/said.table")+T(bSandbox?".sandbox.@1@.":".live.@1@.")+T(nnPeerP)+tDot+TF4(((countT*)&subscriberIdTry)[0],flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_NObASE,0,0x3e)+tDot+TF4(((countT*)&subscriberIdTry)[1],flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_NObASE,0,0x3e)+tDot+tHost ;
                {
                TlIST( tList ) ;

                SCOOPS
            {
            IFsCRATCHoK
            ZE( boolT , bFail ) ;

            }
                if( !tHost.csF( tin0P ) ) tHost = T("factories") ;
                etThread.delF( tin0P , psttHost ) ;
                else            tHost = T(psttHost) ;
                if( !psttHost ) etThread.traceF( tin0P , T("error: reverse DNS lookup on myself failed 591") ) ;
                etThread.sockPsttHostF( tin0P , psttHost ) ; ___( psttHost ) ;
                ZE( strokeS* , psttHost ) ;
            {
            TN( tHost , "" ) ;

            THREADmODE1oN( flTHREADmODE1_ALLOWsTOPwHILEgRABBING )

            }
                said << (strokeS*)tLoginAddressStatus ;
                said << (strokeS*)tLoginAddressZip ;
                said << (strokeS*)tLoginAddressCountry ;
                said << (strokeS*)tLoginAddressCountryCode ;
                said << (strokeS*)tLoginAddressState ;
                said << (strokeS*)tLoginAddressCity ;
                said << (strokeS*)tLoginAddressStreet ;
                said << nnPeerP ;                                   // FORMAT 2
                said << (strokeS*)tLoginNnPeer ;
                said << (strokeS*)tLoginZipUse ;
                said << (strokeS*)tLoginAddressName ;
                said << (strokeS*)tLoginLastName ;
                said << (strokeS*)tLoginFirstName ;
                said << (strokeS*)tLoginPaypalPayerEmail ;
                said << (strokeS*)tLoginIdSubscriber0 ;
                said << (strokeS*)( T("topic: ")+tNewTopic ) ;
                said << (strokeS*)T("") ;
                said << (strokeS*)tFlags ;                          // FORMAT 4
                said << (strokeS*)tTimeForeign ;
                said << (countT)timeN2 ;
                said << timeN1 ;
                said << (countT)4 ;             // IDfORMAT
                said << finger ;
                TN( tFlags , "" ) ;

                putNegAM( *(countT*)&finger , FINGERnEG_WOtABLEsAID ) ;
                ZE( countT , finger ) ;
            {
            soulC said( tin0P , TAG( TAGiDnULL ) ) ;

            }
                newTopic << (strokeS*)tLoginAddressStatus ;
                newTopic << (strokeS*)tLoginAddressZip ;
                newTopic << (strokeS*)tLoginAddressCountry ;
                newTopic << (strokeS*)tLoginAddressCountryCode ;
                newTopic << (strokeS*)tLoginAddressState ;
                newTopic << (strokeS*)tLoginAddressCity ;
                newTopic << (strokeS*)tLoginAddressStreet ;
                newTopic << (strokeS*)tLoginNnPeer ;
                newTopic << (strokeS*)tLoginNnPeer ;
                newTopic << (strokeS*)tLoginZipUse ;
                newTopic << (strokeS*)tLoginAddressName ;
                newTopic << (strokeS*)tLoginLastName ;
                newTopic << (strokeS*)tLoginFirstName ;
                newTopic << (strokeS*)tLoginPaypalPayerEmail ;
                newTopic << (strokeS*)tLoginIdSubscriber0 ;
                newTopic << (strokeS*)tNewTopic ;
                newTopic << (strokeS*)tTimeForeign ;
                newTopic << (countT)timeN2 ;
                newTopic << timeN1 ;
                newTopic << (countT)1 ;             // IDfORMAT
                newTopic << finger ;

                putNegAM( *(countT*)&finger , FINGERnEG_WOtABLEnEWtOPICcERTIFIED ) ;
                ZE( countT , finger ) ;
            {
            soulC newTopic( tin0P , TAG( TAGiDnULL ) ) ;

            textC tTimeForeign( ifcIDtEXTgEN_TIMEnOWfOREIGN , tin0P , TAG( TAGiDnULL ) ) ;

            etThread.osTimeNowF( tin0P , timeN1 , timeN2 ) ;
            ZE( sCountT , timeN2 ) ;
            ZE( countT , timeN1 ) ;
        {
        if( tNewTopic.csF( tin0P ) )

        //etThread.traceF( tin0P , T("new topic:    ")+tNewTopic ) ;

        }
            }
                etThread.traceF( tin0P , T("disk or file error 803") ) ;
                POOPR
            {
            if( POOP )

            }
                }
                    etThread.traceF( tin0P , T("disk or file error 677") ) ;
                    POOPR
                {
                if( POOP )

                }
                    etThread.delF( tin0P , psttSaidCountryCode ) ;
                    rec >> psttSaidCountryCode ; ___( psttSaidCountryCode ) ;
                    ZE( strokeS* , psttSaidCountryCode ) ;

                    etThread.delF( tin0P , psttSaidState ) ;
                    rec >> psttSaidState ; ___( psttSaidState ) ;
                    ZE( strokeS* , psttSaidState ) ;

                    etThread.delF( tin0P , psttSaidCity ) ;
                    rec >> psttSaidCity ; ___( psttSaidCity ) ;
                    ZE( strokeS* , psttSaidCity ) ;

                    etThread.delF( tin0P , psttSaidAddressStreet ) ;
                    rec >> psttSaidAddressStreet ; ___( psttSaidAddressStreet ) ;
                    ZE( strokeS* , psttSaidAddressStreet ) ;

                    rec >> nnPeer ;
                    nicNameC nnPeer ;

                    etThread.delF( tin0P , psttSaidNnPeer ) ;
                    rec >> psttSaidNnPeer ; ___( psttSaidNnPeer ) ;
                    ZE( strokeS* , psttSaidNnPeer ) ;

                    etThread.delF( tin0P , psttSaidZipUse ) ;
                    rec >> psttSaidZipUse ; ___( psttSaidZipUse ) ;
                    ZE( strokeS* , psttSaidZipUse ) ;

                    etThread.delF( tin0P , psttSaidAddressName ) ;
                    rec >> psttSaidAddressName ; ___( psttSaidAddressName ) ;
                    ZE( strokeS* , psttSaidAddressName ) ;

                    etThread.delF( tin0P , psttSaidLastName ) ;
                    rec >> psttSaidLastName ; ___( psttSaidLastName ) ;
                    ZE( strokeS* , psttSaidLastName ) ;

                    etThread.delF( tin0P , psttSaidFirstName ) ;
                    rec >> psttSaidFirstName ; ___( psttSaidFirstName ) ;
                    ZE( strokeS* , psttSaidFirstName ) ;

                    etThread.delF( tin0P , psttSaidPaypalPayerEmail ) ;
                    rec >> psttSaidPaypalPayerEmail ; ___( psttSaidPaypalPayerEmail ) ;
                    ZE( strokeS* , psttSaidPaypalPayerEmail ) ;

                    etThread.delF( tin0P , psttSaidIdSubscriber0 ) ;
                    rec >> psttSaidIdSubscriber0 ; ___( psttSaidIdSubscriber0 ) ;
                    ZE( strokeS* , psttSaidIdSubscriber0 ) ;

                    etThread.delF( tin0P , psttTopicClean ) ;
                    tNewTopic = T(psttTopicClean) ;
                    rec >> psttTopicClean ; ___( psttTopicClean ) ;
                    ZE( strokeS* , psttTopicClean ) ;

                    etThread.delF( tin0P , psttValueTopic ) ;
                    rec >> psttValueTopic ; ___( psttValueTopic ) ;
                    ZE( strokeS* , psttValueTopic ) ;

                    }
                        etThread.delF( tin0P , psttFlags ) ;
                        rec >> psttFlags ; ___( psttFlags ) ;
                        ZE( strokeS* , psttFlags ) ;
                    {
                    if( idFormat >= 4 )

                    etThread.delF( tin0P , psttTimeForeign ) ;
                    rec >> psttTimeForeign ; ___( psttTimeForeign ) ;
                    ZE( strokeS* , psttTimeForeign ) ;

                    rec >> *(countT*)&timeS2 ;
                    ZE( sCountT , timeS2 ) ;

                    rec >> timeS1 ;
                    ZE( countT , timeS1 ) ;

                    rec >> idFormat ;
                    ZE( countT , idFormat ) ;

                    rec >> finger ;
                    ZE( countT , finger ) ;
                {
                else
                }
                    etThread.traceF( tin0P , T("disk or file error 699") ) ;
                    POOPR
                {
                if( POOP )
                ((tin1S&)tin0P).pEtScratch->boxGetF( tin0P , rec , tListSelectTopicLong , 1 , 1 ) ;
                soulC rec( tin0P , *((tin1S&)tin0P).pEtScratch , TAG( TAGiDnULL ) ) ;
            {

            SCOOPS
        {
        IFsCRATCHoK
        TN( tNewTopic , "" ) ;

        }
            TlISTlOAD( tListSelectTopicLong , meP.tListFactoryF() , tSuffix ) ;
            TN( tSuffix , "" ) ; tSuffix = T("d/ideafarm.home.101/ephemeral/backed.up.daily/domains/com/ideafarm/wo.o.s.table/ptopic/")+tValueSelectTopicShort ;
        {
        TlIST( tListSelectTopicLong ) ;
    {
    if( tValueSelectTopicShort.csF( tin0P ) )
    //etThread.traceF( tin0P , T("talkBodyCBF / 5") ) ; //U:: TO FIND A BUG

    }
        }
            }
                if( POOP ) POOPR

                while( !bSecretIsOK && ~hFind && !POOP ) ;
                }
                    DEL( pInfo ) ;
                    }
                        }
                            etThread.traceF( tin0P , T("disk or file error 918") ) ;
                            POOPR
                        {
                        if( POOP )

                        }
                            }
                                etThread.delF( tin0P , psttValueAddressStatus ) ;
                                tLoginAddressStatus = T(psttValueAddressStatus) ;
                                rec >> psttValueAddressStatus ; ___( psttValueAddressStatus ) ;
                                ZE( strokeS* , psttValueAddressStatus ) ;

                                etThread.delF( tin0P , psttValueAddressZip ) ;
                                tLoginAddressZip = T(psttValueAddressZip) ;
                                rec >> psttValueAddressZip ; ___( psttValueAddressZip ) ;
                                ZE( strokeS* , psttValueAddressZip ) ;

                                etThread.delF( tin0P , psttValueAddressCountry ) ;
                                tLoginAddressCountry = T(psttValueAddressCountry) ;
                                rec >> psttValueAddressCountry ; ___( psttValueAddressCountry ) ;
                                ZE( strokeS* , psttValueAddressCountry ) ;

                                etThread.delF( tin0P , psttValueAddressCountryCode ) ;
                                tLoginAddressCountryCode = T(psttValueAddressCountryCode) ;
                                rec >> psttValueAddressCountryCode ; ___( psttValueAddressCountryCode ) ;
                                ZE( strokeS* , psttValueAddressCountryCode ) ;

                                etThread.delF( tin0P , psttValueAddressState ) ;
                                tLoginAddressState = T(psttValueAddressState) ;
                                rec >> psttValueAddressState ; ___( psttValueAddressState ) ;
                                ZE( strokeS* , psttValueAddressState ) ;

                                etThread.delF( tin0P , psttValueAddressCity ) ;
                                tLoginAddressCity = T(psttValueAddressCity) ;
                                rec >> psttValueAddressCity ; ___( psttValueAddressCity ) ;
                                ZE( strokeS* , psttValueAddressCity ) ;

                                etThread.delF( tin0P , psttValueAddressStreet ) ;
                                tLoginAddressStreet = T(psttValueAddressStreet) ;
                                rec >> psttValueAddressStreet ; ___( psttValueAddressStreet ) ;
                                ZE( strokeS* , psttValueAddressStreet ) ;

                                etThread.delF( tin0P , psttValueAddressName ) ;
                                tLoginAddressName = T(psttValueAddressName) ;

                                rec >> psttValueAddressName ; ___( psttValueAddressName ) ;
                                ZE( strokeS* , psttValueAddressName ) ;

                                etThread.delF( tin0P , psttValueLastName ) ;
                                tLoginLastName = T(psttValueLastName) ;
                                rec >> psttValueLastName ; ___( psttValueLastName ) ;
                                ZE( strokeS* , psttValueLastName ) ;

                                etThread.delF( tin0P , psttValueFirstName ) ;
                                tLoginFirstName = T(psttValueFirstName) ;
                                rec >> psttValueFirstName ; ___( psttValueFirstName ) ;
                                ZE( strokeS* , psttValueFirstName ) ;

                                }
                                    //etThread.traceF( tin0P , T(bSecretIsOK?"secret is OK":"secret is NOT ok") ) ;
                                    bSecretIsOK = secretTry == secret ;                 //U::DO THIS ONLY IF THIS RECORD IS NOT AN "UNSUBSCRIBE"
                                {
                                if( subscriberIdTry == idSubscriber )

                                rec >> secret ;
                                ZE( countT , secret ) ;

                                //etThread.traceF( tin0P , T("[tLoginIdSubscriber0]:    ")+tLoginIdSubscriber0 ) ;

                                tLoginIdSubscriber0 = TF4(((countT*)&idSubscriber)[0],flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_NObASE,0,0x3e) ;
                                rec >> ((countT*)&idSubscriber)[ 1 ] ;
                                rec >> ((countT*)&idSubscriber)[ 0 ] ;
                                ZE( count04T , idSubscriber ) ;

                                etThread.delF( tin0P , psttValueTransId ) ;
                                rec >> psttValueTransId ; ___( psttValueTransId ) ;
                                ZE( strokeS* , psttValueTransId ) ;

                                etThread.delF( tin0P , psttValueTransType ) ;
                                rec >> psttValueTransType ; ___( psttValueTransType ) ;
                                ZE( strokeS* , psttValueTransType ) ;

                                etThread.delF( tin0P , psttValueRewardBox ) ;
                                rec >> psttValueRewardBox ; ___( psttValueRewardBox ) ;
                                ZE( strokeS* , psttValueRewardBox ) ;

                                etThread.delF( tin0P , psttValueRewardBoxHidden ) ;
                                rec >> psttValueRewardBoxHidden ; ___( psttValueRewardBoxHidden ) ;
                                ZE( strokeS* , psttValueRewardBoxHidden ) ;

                                etThread.delF( tin0P , psttZipUse ) ;
                                tLoginZipUse = T(psttZipUse) ;
                                rec >> psttZipUse ; ___( psttZipUse ) ;
                                ZE( strokeS* , psttZipUse ) ;

                                etThread.delF( tin0P , psttValuePaypalPayerEmail ) ;
                                tLoginPaypalPayerEmail = T(psttValuePaypalPayerEmail) ;
                                rec >> psttValuePaypalPayerEmail ; ___( psttValuePaypalPayerEmail ) ;
                                ZE( strokeS* , psttValuePaypalPayerEmail ) ;

                                etThread.delF( tin0P , psttNnPeer ) ;
                                tLoginNnPeer = T(psttNnPeer) ;
                                rec >> psttNnPeer ; ___( psttNnPeer ) ;
                                ZE( strokeS* , psttNnPeer ) ;

                                etThread.delF( tin0P , psttAction ) ;
                                rec >> psttAction ; ___( psttAction ) ;
                                ZE( strokeS* , psttAction ) ;

                                rec >> *(countT*)&timeS2 ;
                                ZE( sCountT , timeS2 ) ;

                                rec >> timeS1 ;
                                ZE( countT , timeS1 ) ;

                                rec >> idFormat ;
                                ZE( countT , idFormat ) ;

                                rec >> finger ;
                                ZE( countT , finger ) ;
                            {
                            else
                            }
                                etThread.traceF( tin0P , T("disk or file error 1032") ) ;
                                POOPR
                            {
                            if( POOP )

                            ((tin1S&)tin0P).pEtScratch->boxGetShadowF( tin0P , rec , pInfo->psttIfoName ) ;
                            soulC rec( tin0P , *((tin1S&)tin0P).pEtScratch , TAG( TAGiDnULL ) ) ;
                        {

                        //etThread.traceF( tin0P , T("found 1:    ")+T(fn) ) ;
                        fileNameC fn( tin0P , *((tin1S&)tin0P).pEtScratch , pInfo->psttIfoName ) ;
                    {
                    else
                    }
                        break ;
                        DEL( pInfo ) ;
                    {
                    else if( !pInfo || !pInfo->psttIfoName )
                    }
                        etThread.traceF( tin0P , T("disk or file error 842") ) ;
                        POOPR
                    {
                    if( POOP )

                    ((tin1S&)tin0P).pEtScratch->diskFindFileOrDirF( tin0P , pInfo , hFind , tPath , &pat ) ;
                    ZE( infoFileS* , pInfo ) ;
                {
                do
                handleC hFind( tin0P , TAG( TAGiDnULL ) , ifcIDtYPEhANDLE_FILEfIND ) ;
                patternC pat( tin0P , *((tin1S&)tin0P).pEtScratch , tPattern , ifcIDtYPEpATTERN_FOREIGNwILDCARDsTRICT ) ;
                TN( tPattern , "subscription.table.live.*" ) ;
                TN( tPath , psttc1 ) ;

                SCOOPS
            {
            IFsCRATCHoK
        {
        FORsTRINGSiN1( psttListPath )

        strokeS* psttListPath = tListPath ;

        }
            TlISTlOAD( tListPath , meP.tListFactoryF() , tSuffix ) ;
            TN( tSuffix , "d/ideafarm.home.101/ephemeral/backed.up.daily/domains/com/ideafarm/wo.o.s.table/subscriptions/" ) ;
        {
        TlIST( tListPath ) ;

        //VALIDATE THE SECRET

        /***************************************************************************************************/
        /***************************************************************************************************/
        /***************************************************************************************************/
        /****                                                                                           ****/
        /****  VALIDATE THE ID AND SECRET                                                               ****/
        /****                                                                                           ****/
        /***************************************************************************************************/
        /***************************************************************************************************/
        /***************************************************************************************************/
    {
    if( subscriberIdTry && secretTry )
    TN( tLoginAddressStatus      , "" ) ;
    TN( tLoginAddressZip         , "" ) ;
    TN( tLoginAddressCountry     , "" ) ;
    TN( tLoginAddressCountryCode , "" ) ;
    TN( tLoginAddressState       , "" ) ;
    TN( tLoginAddressCity        , "" ) ;
    TN( tLoginAddressStreet      , "" ) ;
    TN( tLoginAddressName        , "" ) ;
    TN( tLoginLastName           , "" ) ;
    TN( tLoginFirstName          , "" ) ;
    TN( tLoginIdSubscriber0      , "" ) ;
    TN( tLoginZipUse             , "" ) ;
    TN( tLoginPaypalPayerEmail   , "" ) ;
    TN( tLoginNnPeer             , "" ) ;
    ZE( boolT , bSecretIsOK ) ;
    //etThread.traceF( tin0P , T("talkBodyCBF / 6") ) ; //U:: TO FIND A BUG

    countT   secretTry       = etThread.strDigitsToSCountF( tin0P , tValueSecret       , 0x3e ) ;
    count04T subscriberIdTry = etThread.strDigitsToSCountF( tin0P , tValueSubscriberId , 0x3e ) ; //U:: THIS WILL ONLY WORK IF THE ID IS <= MAXCOUNTT

    boolT bDadSecretIsOk = !etThread.strCompareF( tin0P , tValueDadSecretIsOk , T("yes") ) ;

    }
        }
            if( !etThread.strCompareF( tin0P , psttLeverKVP , *pptKey[ offk ] ) ) *pptValue[ offk ] = T((strokeS*)(countT)swKVP) ;
        {
        for( countT offk = 0 ; offk < sizeof pptKey / sizeof pptKey[ 0 ] ; offk ++ )

        //}
        //    DEL( prPosts ) ;
        //    if( prPosts ) meP.pushSnipF( tin0P , stBodyP , *prPosts ) ;
        //    etThread.strMakeF( tin0P , LF , prPosts , tSay , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
        //
        //    etThread.traceF( tin0P , tSay ) ;
        //    TN( tSay , "" ) ; tSay = T("<p>\r\n")+T(psttLeverKVP)+T(":    ")+T((strokeS*)(countT)swKVP) ;
        //
        //    ZE( pbRefC* , prPosts ) ;
        //{

        psttLeverKVP = (strokeS*)swKVP.leverF( tin0P , idf ) ;
    {
    for( countT idf = 1 ; idf <= cFlavors ; idf ++ )
    countT cFlavors = swKVP.cFlavorsF( tin0P ) ;

    } ;
        &tValueDadSecretIsOk       ,
        &tValueSelectTopicShort    ,
        &tValueSecret              ,
        &tValueSubscriberId        ,
    {
    textC* pptValue[] =

    } ;
        &tKeyDadSecretIsOk       ,
        &tKeySelectTopicShort    ,
        &tKeySecret              ,
        &tKeySubscriberId        ,
    {
    textC* pptKey[] =

    TN( tValueDadSecretIsOk       , "" ) ;
    TN( tValueSelectTopicShort    , "" ) ;
    TN( tValueSecret              , "" ) ;
    TN( tValueSubscriberId        , "" ) ;

    TN( tKeyDadSecretIsOk       , "secretisok"         ) ;
    TN( tKeySelectTopicShort    , "filenametopic"      ) ;
    TN( tKeySecret              , "secret"             ) ;
    TN( tKeySubscriberId        , "subscriberid"       ) ;
    TN( tDot , "." ) ;

    /***************************************************************************************************/
    /***************************************************************************************************/
    /***************************************************************************************************/
    /****                                                                                           ****/
    /****  RECEIVE QUERY PARAMETERS                                                                 ****/
    /****                                                                                           ****/
    /***************************************************************************************************/
    /***************************************************************************************************/
    /***************************************************************************************************/

    boolT bSandbox = etherC::ifc_idHomeI_IF() & fliIDhOME_HOMELESS ;

    //if( psttKVReportP && psttKVReportP->idAdam ) etThread.traceF( tin0P , T("body received query: ")+T(psttKVReportP) ) ;
    //etThread.traceF( tin0P , T("[psttNameP]:    ")+T(psttNameP) ) ;
    //etThread.traceF( tin0P , T("talkBodyCBF / 7") ) ; //U:: TO FIND A BUG

    _IO_
{
/*1*/voidT talkBodyCBF( tin0S& tin0P , etherC& etThread , const boolT& bQuitP , httpServerC& meP , countT& cArgP , httpReplyS& replyP , stackC& stBodyP , const strokeS* const psttKVReportP , switchC& swKVP , strokeS*& psttLeverKVP , sessionsC& sessionsP , nicNameC& nnPeerP , const strokeS* const psttNameP , const strokeS* const psttQueryKVP , const strokeS* const psttPeerAgentP , osTextT*& postBodyP )/*1*/

/**/
*/
/*

//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 33 years.
//
// Copyright (c) 1992-2024 Wo Of Ideafarm.  All rights reserved.  See https://github.com/ideafarm/ideafarm.home.1 for permitted uses.
//

