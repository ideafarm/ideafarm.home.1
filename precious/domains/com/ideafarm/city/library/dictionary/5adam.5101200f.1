
//
// Copyright (c) 1992-2024 Wo Of Ideafarm.  All rights reserved.  See https://github.com/ideafarm/ideafarm.home.1 for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 33 years.
// Respecting the rights of other people is an important part of empowering one another.
//


REST

etherC::loafIF( tinP ) ;
etThread.traceF( tinP , T("ok") ) ;

}
    etThread.delF( tinP , postiShortAll ) ;

    }
        ++ s ; ether.osSleepF( tinP , TOCK ) ;
    {
    while( cWorkers )
    sleepC s( tinP , TAG( TAGiDnULL ) ) ;

    }
        etThread.osThreadF( TaRG1( tmWorkerF ) , (countT)&cWorkers , ++ idWorker , (countT)postiShortAll , (countT)ppostEnd ) ;
        inc02AM( cWorkers ) ;
    {
    while( cDo -- )
    ZE( countT , cWorkers ) ;
    ZE( countT , idWorker ) ;
    countT cDo = CwORKERS ;

    if( ppostEnd[ CwORKERS - 1 ] != postiShortAll + costiShortAll ) { BLAMMOiD( 0x98761234 ) ; }                            // ALL PARTITIONS ARE NOW VERIFIED TO BEGIN WITH '!' AND NOT BE NULL LENGTH
    }
        if( ppostEnd[ offe ] <= ppostEnd[ offe - 1 ] ) { BLAMMOiD( 0x72737372 ) ; }
    {
    for( countT offe = 1 ; offe < CwORKERS ; offe ++ )
 
    }
        if(    *ppostEnd[ offe ] != '!' ) { BLAMMOiD( 0x44448888 ) ; }
        while( *ppostEnd[ offe ] != '!' ) ppostEnd[ offe ] ++ ;                                                              // ADJUST END FOR EACH WORKER EXCEPT LATH SO THAT END POINTS TO A '!'
    {
    for( countT offe = 0 ; offe < CwORKERS - 1 ; offe ++ )
 
    ppostEnd[ CwORKERS - 1 ] = postiShortAll + costiShortAll ;                                                              // ppostEnd[] NOW PARTITIONS postiShortAll, BUT PARTITIONS DO NOT BEGIN WITH '!' (THE WOTH CHAR OF A SHORT NAME)
    for( countT offe = 1 ; offe < CwORKERS - 1 ; offe ++ ) ppostEnd[ offe ] = ppostEnd[ offe - 1 ] + cEltPerWorkerRaw ;

    ppostEnd[ 0 ] = postiShortAll + cEltPerWorkerRaw ;
    osTextT* ppostEnd[ CwORKERS ] ;

    const countT cEltPerWorkerRaw = costiShortAll / CwORKERS ;

    if( costiShortAll < CwORKERS ) { BLAMMOiD( 0x55556666 ) ; } //ENSURES THAT cEltPerWorkerRaw IS NOT 0

      etThread.boxGetShadowF( tinP , postiShortAll , costiShortAll , T("///d/tmp/lost7.before.w.duplicates.ttt") ) ; ___( postiShortAll ) ;
    //etThread.boxGetShadowF( tinP , postiShortAll , costiShortAll , T("///d/tmp/lost.after.ttt") ) ; ___( postiShortAll ) ;
    //etThread.boxGetShadowF( tinP , postiShortAll , costiShortAll , T("///d/tmp/lost.before.uscore.to.dot.reformat.uniquifier.seq.ttt") ) ; ___( postiShortAll ) ;
    //etThread.boxGetShadowF( tinP , postiShortAll , costiShortAll , T("///d/tmp/lost.dut2.ttt") ) ; ___( postiShortAll ) ;
    ZE( countT   , costiShortAll ) ;
    ZE( osTextT* , postiShortAll ) ;
{

TODO

DONE( tmWorkerF )
}
    dec02AM( cWorkersP ) ;

    etThread.delF( tinP , posto ) ;
      etThread.boxPutF( tinP , T("///d/tmp/lost7.before." )+TF3(idWorkerP,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_FOREIGN|flFORMAT_FILLzE,2)+T(".ttt") , posto , postoc - posto ) ;
    //etThread.boxPutF( tinP , T("///d/tmp/lost6.after." )+TF3(idWorkerP,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_FOREIGN|flFORMAT_FILLzE,2)+T(".ttt") , posto , postoc - posto ) ;
    //etThread.boxPutF( tinP , T("///d/tmp/lost6.before.")+TF3(idWorkerP,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_FOREIGN|flFORMAT_FILLzE,2)+T(".ttt") , posto , postoc - posto ) ;
    //etThread.boxPutF( tinP , T("///d/tmp/lost6.dut2.")+TF3(idWorkerP,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_FOREIGN|flFORMAT_FILLzE,2)+T(".ttt") , posto , postoc - posto ) ;

    memcpy( postoc , postSeparator , costSeparator ) ; postoc += costSeparator ;

    }
        if( postic >= postieMe ) break ;
        postic = postieWo + 2 ;

        }
            if( !( cWritten % TUCK ) ) etThread.traceF( tinP , TF2(cWritten,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED) ) ;
            cWritten ++ ;
            postiLathWritten = postic ;

            memcpy( postoc , "\r\n" , 2      ) ; postoc += 2      ;
            memcpy( postoc , postic , costic ) ; postoc += costic ;
        {
        if( !bSkip )

        //boolT bSkip = postiLathWritten && !thirdC::c_strcmpIF( tinP , postic , postiLathWritten , 0 ) ;
          boolT bSkip = postiLathWritten && !memcmp( postic , postiLathWritten , costic ) ;

        countT costic = postieWo - postic ;
        *postieWo = 0 ;

        //osTextT* postieWo = thirdC::c_strstrIF( tinP , postic , "\r\n" ) ;
          osTextT* postieWo = strstr( postic , "\r\n" ) ;
    {
    while( !ether )
    ZE( countT , cWritten ) ;
    ZE( osTextT* , postiLathWritten ) ;

    osTextT* postoc = posto ;
    etThread.newF( tinP , LF , posto , costiMe + costSeparator ) ; ___( posto ) ;
    ZE( osTextT* , posto ) ;

    osTextT* postic = postiMe ;

    countT   costiMe  = postieMe - postiMe ;
    osTextT* postieMe = ppostEndP[ idWorkerP - 1 ] ;

    ;
        : ppostEndP[ idWorkerP - 2 ]
        ? postiShortAllP
    osTextT* postiMe = idWorkerP == 1

    osTextT** const ppostEndP      = (osTextT**)pTaskP->c4 ;
    osTextT* const  postiShortAllP =  (osTextT*)pTaskP->c3 ;
    const countT    idWorkerP      =            pTaskP->c2 ;
    countT&         cWorkersP      =  *(countT*)pTaskP->c1 ;
{
if( pTaskP && pTaskP->c1 && pTaskP->c2 && pTaskP->c3 && pTaskP->c4 )
TASK( tmWorkerF )

const countT  costSeparator   = sizeof postSeparator - 1 ;
const osTextT postSeparator[] = "--------------------------\r\n" ;

#define CwORKERS 0x10
//A:ASSUME: NOT 1 OR 0

//P:PERSONALITY: EACH THREAD ADJUSTS ITS WINDOW UPWARD TO BEGIN AND END AT AN '!'

//A:ASSUME: BOTH INPUT FILES ARE SORTED ; BOTH MAY CONTAIN DUPLICATE LINES

/*1*/WAKEsHOWtEXT( "doodle.remove.duplicate.lines.multithreaded" )/*1*/
/**/
*/
/*

//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 33 years.
//
// Copyright (c) 1992-2024 Wo Of Ideafarm.  All rights reserved.  See https://github.com/ideafarm/ideafarm.home.1 for permitted uses.
//
